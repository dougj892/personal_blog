"0","# Load required pacakges"
"0","library(tidyverse); library(survey); library(haven); library(tidymodels)"
"0",""
"0","# Load the Stata version of the individual level IHDS file"
"0","# To get this file go to https://www.icpsr.umich.edu/web/DSDR/studies/36151"
"0","# Then click ""download"" and ""stata"". You will need to create a login and you will get a bunch of other files in addition to this one."
"0","ihds_ind_dir <- ""C:/Users/dougj/Documents/Data/IHDS/IHDS 2012/DS0001"""
"0","ind_file <- file.path(ihds_ind_dir, ""36151-0001-Data.dta"")"
"0","ihds <- read_dta(ind_file, col_select = c(STATEID, DISTID, PSUID, URBAN2011, HHID, HHSPLITID, PERSONID, IDPSU, WT, RO3, RO7, RO5, COPC, ASSETS, GROUPS, HHEDUC, HHEDUCM, HHEDUCF, INCOME, NPERSONS,starts_with(""CS""), starts_with(""TA""), starts_with(""ED"")))"
"0",""
"0","# Create variables for full PSU ID, HH ID, ASER score, and state"
"0","ihds <- ihds %>% "
"0","  mutate(psu_expanded = paste(STATEID, DISTID, PSUID, sep =""-""), "
"0","         hh_expanded = paste(STATEID, DISTID, PSUID, HHID, HHSPLITID, sep =""-""),"
"0","         ASER4 = (TA8B ==4),"
"0","         State = as_factor(STATEID)) %>% "
"0","  filter(!is.na(WT))"
"0",""
"0",""
"0","# Specify the survey design"
"0","# note that this and the line after can take a minute or two"
"0","ihds_svy <- svydesign(id =~ psu_expanded + hh_expanded, weights =~ WT, data = ihds)"
"0",""
"0","# Estimate the mean of ASER4 for the full country and get the standard error"
"0","svymean(~ASER4, ihds_svy, na.rm =TRUE)"
"1","          "
"1","    mean"
"1","     SE"
"1","
ASER4FALSE"
"1"," 0.67279"
"1"," 0.0084"
"1","
ASER4TRUE "
"1"," 0.32721"
"1"," 0.0084"
"1","
"
