"0","library(haven); library(gt)"
"0","ihds_ind_dir <- ""C:/Users/dougj/Documents/Data/IHDS/IHDS 2012/DS0001"""
"0","ind_file <- file.path(ihds_ind_dir, ""36151-0001-Data.dta"")"
"0",""
"0","# read in just those variables that i need"
"0","ihds <- read_dta(ind_file, col_select = c(STATEID, HHID, HHSPLITID, PERSONID, WT, RO3, RO7, RO5, URBAN2011, starts_with(""CS""), starts_with(""TA""), starts_with(""ED"")))"
"0",""
"0","# drop the one row with missing values for weights and convert STATEID to factor"
"0","ihds <- ihds %>% filter(!is.na(WT)) %>% mutate(State = as_factor(STATEID))"
"0",""
"0","# Look at the average of all students in TN and HP versus the rest of the country"
"0","tn_hp <- ihds %>% "
"0","  mutate(Area = (State == ""Tamil Nadu 33"" | State == ""Himachal Pradesh 02"")) %>% "
"0","  mutate(Area = if_else(Area, ""HP and TN"", ""All other states"")) %>% "
"0","  group_by(Area) %>% "
"0","  summarize(reading = weighted.mean(TA8B, WT, na.rm = TRUE), "
"0","            math = weighted.mean(TA9B, WT, na.rm = TRUE)) "
"0",""
"0",""
"0","gt(tn_hp) %>% "
"0","  fmt_number("
"0","    columns = c(""reading"", ""math""),"
"0","    decimals = 2"
"0","  )"
